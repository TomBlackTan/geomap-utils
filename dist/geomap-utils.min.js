/*!
  * geomap-utils v0.1.0
  * (c) 2018 Esri China PS
  * @license MIT
  */
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):e.GeomapUtils=r()}(this,function(){"use strict";function d(e){var r,t,n,o=(r=e,document.querySelector('link[href*="'+r+'"]'));return o||(t=e,(n=document.createElement("link")).rel="stylesheet",n.href=t,o=n,document.head.appendChild(o)),o}var u,e="undefined"!=typeof window,r="https://js.arcgis.com/4.10/";function c(e,r,t){var n,o,i,a;t&&(i=t,a=function(e){i(e.error||new Error("There was an error attempting to load "+o.src)),o.removeEventListener("error",a,!1)},(o=e).addEventListener("error",a,!1),n=a);var d=function(){r(e),e.removeEventListener("load",d,!1),n&&e.removeEventListener("error",n,!1)};e.addEventListener("load",d,!1)}var t={Promise:e?window.Promise:void 0};function l(){return document.querySelector("script[data-esri-loader]")}function s(){var e=window.require;return e&&e.on}function n(a){return void 0===a&&(a={}),a.url||(a.url=r),new t.Promise(function(e,r){var t,n,o=l();if(o){var i=o.getAttribute("src");i!==a.url?r(new Error("The ArcGIS API for JavaScript is already loaded ("+i+").")):s()?e(o):c(o,e,r)}else s()?r(new Error("The ArcGIS API for JavaScript is already loaded.")):(a.css&&d(a.css),a.dojoConfig&&(window.dojoConfig=a.dojoConfig),t=a.url,(n=document.createElement("script")).type="text/javascript",n.src=t,n.setAttribute("data-esri-loader","loading"),o=n,u=a.url,c(o,function(){o.setAttribute("data-esri-loader","loaded"),e(o)},r),document.body.appendChild(o))})}function o(r){return new t.Promise(function(n,e){var o=window.require.on("error",e);window.require(r,function(){for(var e=arguments,r=[],t=0;t<arguments.length;t++)r[t]=e[t];o.remove(),n(r)})})}var i={getScript:l,isLoaded:s,loadModules:function(e,r){return void 0===r&&(r={}),s()?o(e):(!r.url&&u&&(r.url=u),n(r).then(function(){return o(e)}))},loadScript:n,loadCss:d,utils:t};function a(e,r){return e.map.layers.find(function(e){return e.title===r})}function f(e,r){var t=e.createQuery();return t.where=r,e.queryFeatures(t)}var m,v={jsapi:{load:function(e){var r={};return window.dojoConfig&&(r.dojoConfig=window.dojoConfig),window.apiRoot&&(r.url=window.apiRoot),i.loadModules(e,r)}},view:{map2d:{getLayerByTitle:a,getLayerByIndex:function(e,r){return e.map.layers.getItemAt(r)},getLayerById:function(e,r){return e.map.findLayerById()},setLayerVisible:function(e,r,t){a(e,r).visible=t},highlightByLayerObjid:function(e,r,t){var n=a(e,r);e.whenLayerView(n).then(function(e){e.highlight(1*t)})},queryFeathersFromLayer:f,queryFeathersFromLayer:f,highlightByLayerGraphic:function(e,r,t,n){var o=null;e.whenLayerView(r).then(function(e){o&&o.remove(),o=e.highlight(t)}),e.on("click",function(e){o&&o.remove()}),n&&e.goTo({target:t.geometry,tilt:70},{duration:2e3,easing:"in-out-expo"})}},map3d:{gotoBySliderName:function(r,t){var e=r.map.presentation.slides.items,n={duration:3e3,maxDuration:3e3};e.forEach(function(e){e.title.text===t&&r.goTo(e.viewpoint,n)})}}}};return"undefined"!=typeof window&&(window.agsUtils=v),(m=Object.freeze({default:v}))&&m.default||m});